dist: bionic
language: java

before_script:
  - echo "deb [arch=amd64] https://storage.googleapis.com/bazel-apt stable jdk1.8" | sudo tee /etc/apt/sources.list.d/bazel.list
  - curl https://bazel.build/bazel-release.pub.gpg | sudo apt-key add -
  - sudo apt-get update -qq
  - sudo apt-get install bazel -y

install:
  - curl https://raw.githubusercontent.com/algorand/algorand-sdk-testing/master/scripts/sdkupdate.sh -o ~/sdkupdate.sh
  - chmod +x ~/sdkupdate.sh

script:
  - mvn test -q
  - bazel test //... --incompatible_depset_is_not_iterable=false
  - ~/sdkupdate.sh --java
